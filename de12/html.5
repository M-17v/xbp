<!DOCTYPE html>
<html lang="jp">
    <title>ğŸ–¤</title>
    <link rel="stylesheet" href="./css/style.css">
<head></head>
<h3>ç¬¬5å›èª²é¡Œ<br>
<br>Windowsã®å£ç´™ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’pythonã§ä½œæˆ
<br>
<h4>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h4>
ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰<br>

<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">import ctypes</li>
    <li style="background-color:#EEF;">import os</li>
    <li style="background-color:#EFF;">import glob</li>
    <li style="background-color:#EEF;">import time</li>
    <li style="background-color:#EFF;">import threading</li>
    <li style="background-color:#EEF;">import random</li>
    <li style="background-color:#EFF;">import codecs</li>
    <li style="background-color:#EEF;">import sys</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">INTERVAL_SEC = 3</li>
    <li style="background-color:#EFF;">class BgSlider()</li>
    <li style="background-color:#EEF;">#classã¨ã¯ã€Œã²ãªå‹ã€ã®äº‹ã§ã€ã²ãªå‹ã®ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹é ˜åŸŸã€å‡¦ç†ã®ä»•æ–¹ã‚’æ›¸ãé ˜åŸŸã‚’è¨­ã‘ã‚‹ã€‚<br></li>
    <li style="background-color:#EFF;">def __init__(self):</li>
    <li style="background-color:#EEF;">self.index = 0</li>
    <li style="background-color:#EFF;">self.directory = None</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">def setup(self):</li>
    <li style="background-color:#EEF;">global off/li>
    <li style="background-color:#EFF;">with codecs.open('path.txt', 'r', 'utf-8') as f:<br></li>
    <li style="background-color:#EEF;">#withæ§‹æ–‡ã¯ã€cLoseå‡¦ç†ã‚’çœã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚é–‹å§‹æ™‚ã¨çµ‚äº†æ™‚ã®å®šå‹å‡¦ç†ã‚’å¿…ãšå®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã€‚</li>
    <li style="background-color:#EFF;">#asã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ©ã‚¤ãƒ—ãƒ©ãƒªåã«å¥½ããªåå‰ã‚’ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</li>
    <li style="background-color:#EEF;">#path.txtã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¥½ããªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ›¸ãæ›ãˆã‚‹ã€‚<br> </li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;lines = f.readlines()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.directory = lines[0].strip()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
    <li style="background-color:#EEF;"></li>def worker(self):
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;path = self.directory + r'\*.jpg'</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path.replace('\\\\', '\\')</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with codecs.open(r<font style="color:brown;">files = glob.glob(path)<br></font>, <font style="color:brown;">'r'</font>, <font style="color:brown;">'utf-8'</font>) as f:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# [print(file) for file in files] </li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã¦å‡ºåŠ›ã™ã‚‹ã¨ãã«ä½¿ã†</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#file = files[random.randint(0, len(files) - 1)] </li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†<br></li>
    <li style="background-color:#EEF;"></li>files = sorted(files) <br>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def worker(self):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path = self.directory + r<font style="color:brown;">'\*.jpg'</font></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path.replace(<font style="color:brown;">'\\\\', '</font>\\')</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files = glob.glob(path)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# [print(file) for file in files] # ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã¦å‡ºåŠ›ã™ã‚‹ã¨ãã«ä½¿ã†</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# file = files[random.randint(0, len(files) - 1)] # ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files = sorted(files) # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file = files[self.index] # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(file)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctypes.windll.user32.SystemParametersInfoW(20, 0, file, 0)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.index == len(files) - 1:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.index = 0</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.index += 1</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(INTERVAL_SEC)</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def schedule(self, interval, f, wait=True):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_time = time.time()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_time = 0</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:#whileâ†’æŒ‡å®šã—ãŸæ¡ä»¶ãŒçœŸã®é–“ã€å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œ</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = threading.Thread(target=f)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.start()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if wait:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.join()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_time = ((base_time - time.time()) % interval) or interval</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(next_time)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except KeyboardInterrupt:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit()</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">if __name__ == "__main__":</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg = BgSlider()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg.setup()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg.schedule(INTERVAL_SEC, bg.worker, False)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;finally:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctypes.windll.user32.SystemParametersInfoW(20, 0, None, 0)</li>
    </ol></code>
<br>
<br>