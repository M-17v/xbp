<!DOCTYPE html>
<html lang="jp">
    <title>ğŸ–¤</title>
    <link rel="stylesheet" href="./css/style.css">
<head></head>
<h3>ç¬¬5å›èª²é¡Œ<br>
<br>Windowsã®å£ç´™ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’pythonã§ä½œæˆ
<br>
<h4>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h4>
ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰<br>

<code>
    <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
    <li style="background-color:#EFF;">import ctypes</li>
    <li style="background-color:#EEF;">import os</li>
    <li style="background-color:#EFF;">import glob</li>
    <li style="background-color:#EEF;">import time</li>
    <li style="background-color:#EFF;">import threading</li>
    <li style="background-color:#EEF;">import random</li>
    <li style="background-color:#EFF;">import codecs</li>
    <li style="background-color:#EEF;">import sys</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">#importâ†’å¤–ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€</li>
    <li style="background-color:#EFF;">#ctypesâ†’å¤–éƒ¨é–¢æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆä»–ã®äººãŒä½œã£ãŸæ©Ÿèƒ½ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ãŸã‚‚ã®ï¼Ÿï¼‰ã‚’ä½¿ã†ã®ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚</li>
    <li style="background-color:#EEF;">#osâ†’ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’ä»²ä»‹ã—ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚’åˆ¶å¾¡ã™ã‚‹ã€‚</li>
    <li style="background-color:#EFF;">#globâ†’ç‰¹å®šã®æ¡ä»¶ã«ãƒãƒƒãƒã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã§ä½¿ã†ã®ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚</li>
    <li style="background-color:#EEF;">#threadingâ†’ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ï¼ˆã‚¢ãƒ—ãƒªã®ã‚¿ã‚¹ã‚¯ã‚’è¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«åˆ†ã‘ã¦ä¸¦è¡Œå‡¦ç†ã™ã‚‹æ–¹å¼ï¼‰ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚</li>
    <li style="background-color:#EFF;">#codecsâ†’ãƒ‡ãƒ¼ã‚¿ã®ç¬¦å·åŒ–ã‚„åœ§ç¸®ãƒ»è§£å‡</li>
    <li style="background-color:#EEF;">#sysâ†’sysã¨ã„ã†æ‹¡å¼µå­ã‚’ä½¿ã†ã®ã‚’å¯èƒ½ã«ã™ã‚‹ï¼Ÿ</li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">INTERVAL_SEC = 3</li>
    <li style="background-color:#EFF;">#å£ç´™ãŒå¤‰ã‚ã‚‹ã¾ã§ã®ç§’æ•°ã‚’æŒ‡å®š</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">class BgSlider():#classã«ã‚ˆã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹é ˜åŸŸã¨å‡¦ç†ã®ä»•æ–¹ã‚’æ›¸ãé ˜åŸŸã‚’è¨­ã‘ã‚‹ã€‚</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.index = 0</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.directory = None</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def setup(self):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global off</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with codecs.open(r<font style="color:brown;">'C:\Users\ã‚ã‚†ã¿\mygit\xbp\de12\images'</font>, <font style="color:brown;">'r'</font>, <font style="color:brown;">'utf-8'</font>) as f:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lines = f.readlines()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.directory = lines[0].strip()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#å¥½ããªç”»åƒã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å–ã‚Šè¾¼ã‚€</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ã“ã“ãŒã†ã¾ãã„ã‹ãªã„ï¼</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def worker(self):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path = self.directory + r<font style="color:brown;">'\*.jpg'</font></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path.replace(<font style="color:brown;">'\\\\', '</font>\\')</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files = glob.glob(path)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# [print(file) for file in files] # ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã¦å‡ºåŠ›ã™ã‚‹ã¨ãã«ä½¿ã†</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# file = files[random.randint(0, len(files) - 1)] # ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files = sorted(files) # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file = files[self.index] # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(file)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctypes.windll.user32.SystemParametersInfoW(20, 0, file, 0)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.index == len(files) - 1:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.index = 0</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.index += 1</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(INTERVAL_SEC)</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;def schedule(self, interval, f, wait=True):</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_time = time.time()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_time = 0</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:#whileâ†’æŒ‡å®šã—ãŸæ¡ä»¶ãŒçœŸã®é–“ã€å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œ</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = threading.Thread(target=f)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.start()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if wait:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.join()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_time = ((base_time - time.time()) % interval) or interval</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(next_time)</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except KeyboardInterrupt:</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit()</li>
    <li style="background-color:#EEF;"></li>
    <li style="background-color:#EFF;"></li>
    <li style="background-color:#EEF;">if __name__ == "__main__":</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg = BgSlider()</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg.setup()</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bg.schedule(INTERVAL_SEC, bg.worker, False)</li>
    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;finally:</li>
    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctypes.windll.user32.SystemParametersInfoW(20, 0, None, 0)</li>
    </ol></code>
<br>
<br>