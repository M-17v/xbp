<!DOCTYPE html>
<html lang="jp">
    <title>ğŸ¤</title>
    <link rel="stylesheet" href="./css/style.css">
<head></head>
<h3>ç¬¬5å›èª²é¡Œ<br>
<br>Windowsã®å£ç´™ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’pythonã§ä½œã£ã¦ã¿ãŸ
<br>
<h4>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h4>
<pre><code>
    import ctypes
    import os
    import glob
    import time
    import threading
    import random
    import codecs
    import sys
    
    INTERVAL_SEC = 3
    
    
    class BgSlider():
    #classã¨ã¯ã€Œã²ãªå‹ã€ã®äº‹ã§ã€ã²ãªå‹ã®ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹é ˜åŸŸã€å‡¦ç†ã®ä»•æ–¹ã‚’æ›¸ãé ˜åŸŸã‚’è¨­ã‘ã‚‹ã€‚
        def __init__(self):
            self.index = 0
            self.directory = None
    
        def setup(self):
            global off
            with codecs.open('path.txt', 'r', 'utf-8') as f:
    #withæ§‹æ–‡ã¯ã€cLoseå‡¦ç†ã‚’çœã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚é–‹å§‹æ™‚ã¨çµ‚äº†æ™‚ã®å®šå‹å‡¦ç†ã‚’å¿…ãšå®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã€‚
    #asã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ©ã‚¤ãƒ—ãƒ©ãƒªåã«å¥½ããªåå‰ã‚’ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
    #path.txtã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¥½ããªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ›¸ãæ›ãˆã‚‹ã€‚    
                lines = f.readlines()
                self.directory = lines[0].strip()
    
        def worker(self):
            path = self.directory + r'\*.jpg'
            path.replace('\\\\', '\\')
            files = glob.glob(path)
            # [print(file) for file in files] # ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã¦å‡ºåŠ›ã™ã‚‹ã¨ãã«ä½¿ã†
            # file = files[random.randint(0, len(files) - 1)] # ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†
            files = sorted(files) # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†
            file = files[self.index] # é †ç•ªã«è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã“ã“ã‚’ä½¿ã†
            print(file)
            ctypes.windll.user32.SystemParametersInfoW(20, 0, file, 0)
            if self.index == len(files) - 1:
                self.index = 0
            else:
    #elseã¨ã¯ã€æ¡ä»¶å¼ãŒFalseã®å ´åˆè¡Œã†å‡¦ç†
                self.index += 1
            time.sleep(INTERVAL_SEC)
    
        def schedule(self, interval, f, wait=True):
            base_time = time.time()
            next_time = 0
            while True:
    #whileæ–‡ã¯æŒ‡å®šã—ãŸæ¡ä»¶å¼ãŒçœŸã®é–“ã€å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã€‚åŸºæœ¬çš„ãªæ›¸å¼â†’while æ¡ä»¶å¼:æ¡ä»¶å¼ãŒçœŸã®æ™‚ã«å®Ÿè¡Œã™ã‚‹æ–‡
                try:
    #tryã¯ä¾‹å¤–å‡¦ç†ã®åŸºæœ¬ã§ãã®ä»–ã«exceptãŒã‚ã‚‹
                    t = threading.Thread(target=f)
                    t.start()
                    if wait:
    #Python ã§æ¡ä»¶åˆ†å²ã‚’è¡Œã†éš›ã«if æ–‡ã‚’ä½¿ç”¨ã™ã‚‹
                        t.join()
                    next_time = ((base_time - time.time()) % interval) or interval
                    time.sleep(next_time)
                except KeyboardInterrupt:
    #exceptã¯ä¾‹å¤–å‡¦ç†ã®åŸºæœ¬ã§ãã®ä»–ã«tryãŒã‚ã‚‹
                    exit()
    
    
    if __name__ == "__main__":
        try:
    #tryã¯ä¾‹å¤–å‡¦ç†ã®åŸºæœ¬ã§ãã®ä»–ã«exceptãŒã‚ã‚‹
    
            bg = BgSlider()
            bg.setup()
            bg.schedule(INTERVAL_SEC, bg.worker, False)
        finally:
    #finallyã¯çµ‚äº†æ™‚ã«å¸¸ã«è¡Œã†å‡¦ç†ã®ã“ã¨
            c.windll.user32.SystemParametersInfoW(20, 0, None, 0)
        </code></pre>